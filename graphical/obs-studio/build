#!/bin/sh -e

patch -p1 < ignore_unused_submodules.patch

mkdir -p build
cd build

# cmake .. \
# 	-DCMAKE_INSTALL_PREFIX=/usr \
# 	-DCMAKE_LIBDIR=lib \
# 	-DBUILD_FOR_DISTRIBUTION=ON \
# 	-DBUILD_TESTS=OFF \
# 	-DENABLE_WAYLAND=OFF \
# 	-DENABLE_PULSEAUDIO=OFF \
# 	-DENABLE_PIPEWIRE=OFF \
# 	-DENABLE_V4L2=OFF \
# 	-DENABLE_VLC=OFF \
# 	-DENABLE_VST=OFF \
# 	-DENABLE_SPEEXDSP=OFF \
# 	-DENABLE_AJA=OFF \
# 	-DENABLE_BROWSER=OFF
cmake .. \
	-DCMAKE_INSTALL_PREFIX=/usr \
	-DENABLE_WAYLAND=OFF \
	-DENABLE_PULSEAUDIO=OFF \
	-DENABLE_PIPEWIRE=OFF \
	-DBUILD_VST=OFF \
	-DENABLE_AJA=OFF \
	-DENABLE_V4L2=ON \
	-DENABLE_BROWSER=OFF \
	-DENABLE_VLC=OFF \
	-DENABLE_JACK=ON \
	-DENABLE_NEW_MPEGTS_OUTPUT=OFF \
	-DENABLE_SPEEXDSP=OFF

make
make install

rm -rf "$1/home" "$1/root"
